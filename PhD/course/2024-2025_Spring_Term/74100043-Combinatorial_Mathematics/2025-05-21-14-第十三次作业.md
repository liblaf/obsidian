---
created: 2025-05-26T19:24:20+08:00
modified: 2025-05-26T21:17:32+08:00
tags:
  - Linear_Programming
  - PhD/Course/Combinatorial_Mathematics
title: 第十三次作业
---

## 6.1.

> [!QUESTION]
> 利用图解求下列问题的解.
> (1) $\max z = 2 x_1 + x_2$
> $$
>   \begin{cases}
>     x_1 + 4 x_2 \leqslant 32 \\
>     x_1 + x_2 \leqslant 11   \\
>     5 x_1 + x_2 \leqslant 35 \\
>     x_1, x_2 \geqslant 0
>   \end{cases}
> $$
> (2) $\max z = x_1 + x_2$
> $$
>   \begin{cases}
>     4 x_1 + 5 x_2 \leqslant 10 \\
>     5 x_1 + 2 x_2 \leqslant 10 \\
>     3 x_1 + 8 x_2 \leqslant 12 \\
>     x_1, x_2 \geqslant 0
>   \end{cases}
> $$
> (3) $\max z = 2 x_1 + x_2$
> $$
>   \begin{cases}
>     - x_1 + x_2 \leqslant 1 \\
>     x_1 + x_2 \leqslant 3 \\
>     x_1, x_2 \geqslant 0
>   \end{cases}
> $$
> (4) $\max z = x_1 + x_2$
> $$
>   \begin{cases}
>     - x_1 + 2 x_2 \leqslant 2 \\
>     x_1 - x_2 \geqslant 2 \\
>     x_1, x_2 \geqslant 0
>   \end{cases}
> $$

Images generated by: [Linear programming grapher (two variables)](https://www.zweigmedia.com/utilities/lpg/index.html)

### 6.1. (1)

![](IMG-2025-05-26T210412+0800.png)

### 6.1. (2)

![](IMG-2025-05-26T210403+0800.png)

### 6.1. (3)

![](IMG-2025-05-26T210642+0800.png)

### 6.1. (4)

![](IMG-2025-05-26T211239+0800.png)

## 6.2.

> [!QUESTION]
> 利用单纯形法求问题 1 的解.

### 6.2. (1)

**转换为标准形式:** 引入松弛变量 $s_1, s_2, s_3 \geqslant 0$, 得到:
$$
\begin{aligned}
  \max z                  & = 2 x_1 + x_2 + 0 s_1 + 0 s_2 + 0 s_3 \\
  \text{s.t.} \quad
  x_1 + 4x_2 + s_1        & = 32 \\
  x_1 + x_2 + s_2         & = 11 \\
  5x_1 + x_2 + s_3        & = 35 \\
  x_1, x_2, s_1, s_2, s_3 & \geqslant 0
\end{aligned}
$$

**初始单纯形表:** 初始基变量为 $s_1, s_2, s_3$, 对应解为 $x_1 = 0, x_2 = 0, s_1 = 32, s_2 = 11, s_3 = 35$, 目标值 $z = 0$. 构建初始单纯形表如下:

| 基变量   | $x_1$ | $x_2$ | $s_1$ | $s_2$ | $s_3$ | 右侧    |
| ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| $s_1$ | 1     | 4     | 1     | 0     | 0     | 32    |
| $s_2$ | 1     | 1     | 0     | 1     | 0     | 11    |
| $s_3$ | 5     | 1     | 0     | 0     | 1     | 35    |
| 检验数   | 2     | 1     | 0     | 0     | 0     | $z=0$ |

**第一次迭代:**
- **进基变量:** 检验数最大正值为 $2$, 选 $x_1$.
- **出基变量:** 计算最小比值 $\min(32/1, 11/1, 35/5) = 7$, 对应 $s_3$ 出基.
- **主元:** $s_3$ 行 $x_1$ 列元素 $5$.

将 $s_3$ 行除以 $5$:
$$
  x_1 + 0.2 x_2 + 0.2 s_3 = 7
$$  
消去其他行中的 $x_1$:
- $s_1$ 行: $s_1 = 32 - x_1 -4 x_2 \implies s_1 = 25 - 3.8 x_2 - 0.2 s_3$
- $s_2$ 行: $s_2 = 11 - x_1 - x_2 \implies s_2 = 4 - 0.8 x_2 - 0.2 s_3$

更新单纯形表:

| 基变量   | $x_1$ | $x_2$   | $s_1$ | $s_2$ | $s_3$ | 右侧     |
| ----- | ----- | ------- | ----- | ----- | ----- | ------ |
| $s_1$ | 0     | 3.8     | 1     | 0     | -0.2  | 25     |
| $s_2$ | 0     | 0.8     | 0     | 1     | -0.2  | 4      |
| $x_1$ | 1     | 0.2     | 0     | 0     | 0.2   | 7      |
| 检验数   | 0     | **0.6** | 0     | 0     | -0.4  | $z=14$ |

**第二次迭代:**
- **进基变量:** 检验数最大正值为 $0.6$, 选 $x_2$.
- **出基变量:** 计算最小比值 $\min(25/3.8 \approx 6.58, 4/0.8=5, 7/0.2=35)$, 对应 $s_2$ 出基.
- **主元:** $s_2$ 行 $x_2$ 列元素 $0.8$.

将 $s_2$ 行除以 $0.8$:
$$
  x_2 + 1.25 s_2 - 0.25 s_3 = 5
$$  
消去其他行中的 $x_2$:
- $s_1$ 行: $s_1 = 25 - 3.8 x_2 + 0.2 s_3 \implies s_1 = 6 - 4.75 s_2 + 0.75 s_3$
- $x_1$ 行: $x_1 = 7 - 0.2 x_2 - 0.2 s_3 \implies x_1 = 6 + 0.25 s_3 - 0.25 s_2$

更新单纯形表:

| 基变量   | $x_1$ | $x_2$ | $s_1$ | $s_2$     | $s_3$     | 右侧     |
| ----- | ----- | ----- | ----- | --------- | --------- | ------ |
| $s_1$ | 0     | 0     | 1     | -4.75     | 0.75      | 6      |
| $x_2$ | 0     | 1     | 0     | 1.25      | -0.25     | 5      |
| $x_1$ | 1     | 0     | 0     | -0.25     | 0.25      | 6      |
| 检验数   | 0     | 0     | 0     | **-0.75** | **-0.25** | $z=17$ |

**最优解判定:**
检验数均为非正数, 达到最优解.
**最优解:** $x_1 = 6, x_2 = 5, s_1 = 6$, 目标值 $z = 2 \cdot 6 + 1 \cdot 5 = 17$.

### 6.2. (2)

#### 标准化

引入松弛变量 $s_1, s_2, s_3 \geq 0$, 将不等式转为等式:
$$
\begin{cases} 
  4 x_1 + 5 x_2 + s_1 = 10 \\
  5 x_1 + 2 x_2 + s_2 = 10 \\
  3 x_1 + 8 x_2 + s_3 = 12 \\
  x_1, x_2, s_1, s_2, s_3 \geqslant 0 
\end{cases}
$$
目标函数保持不变: $\max z = x_1 + x_2$.

#### 初始单纯形表

基变量为 $s_1, s_2, s_3$, 初始解为 $x_1 = 0, x_2 = 0, s_1 = 10, s_2 = 10, s_3 = 12$, 对应 $z = 0$.

$$
\begin{array}{c|ccccc|c}
  \text{基变量} & x_1 & x_2 & s_1 & s_2 & s_3 & \text{解} \\
  \hline
  s_1 & 4 & 5 & 1 & 0 & 0 & 10 \\
  s_2 & 5 & 2 & 0 & 1 & 0 & 10 \\
  s_3 & 3 & 8 & 0 & 0 & 1 & 12 \\
  \hline
  \text{检验数} & 1 & 1 & 0 & 0 & 0 & 0 \\
\end{array}
$$

#### 第一次迭代

1. **选择进基变量:** 检验数中最大正值对应的变量 $x_1$ (系数为 1).
2. **选择出基变量:** 计算比值 $\frac{\text{解}}{\text{进基列系数}}$, 最小比值为 $\frac{10}{5} = 2$, 对应 $s_2$ 出基.
3. **主元行变换:** 将 $s_2$ 行除以 5, 得到新行:
$$
  x_1 + \frac{2}{5} x_2 + 0 s_1 + \frac{1}{5} s_2 + 0 s_3 = 2
$$
4. **更新其他行:**
$s_1$ 行减去 $4 \times$ 新行:
$$
  0x_1 + \frac{17}{5}x_2 + s_1 - \frac{4}{5} s_2 = 2
$$
$s_3$ 行减去 $3 \times$ 新行:
$$
  0 x_1 + \frac{34}{5} x_2 + s_3 - \frac{3}{5} s_2 = 6
$$
5. **更新检验数:**
目标行减去 $1 \times$ 新行, 得到新检验数:
$$
  0 x_1 - \frac{3}{5} x_2 + 0 s_1 + \frac{1}{5} s_2 + 0 s_3 = 2
$$
更新后的单纯形表：
$$
\begin{array}{c|ccccc|c}
  \text{基变量} & x_1 & x_2 & s_1 & s_2 & s_3 & \text{解} \\
  \hline
  s_1 & 0 & \frac{17}{5} & 1 & -\frac{4}{5} & 0 & 2 \\
  x_1 & 1 & \frac{2}{5} & 0 & \frac{1}{5} & 0 & 2 \\
  s_3 & 0 & \frac{34}{5} & 0 & -\frac{3}{5} & 1 & 6 \\
  \hline
  \text{检验数} & 0 & -\frac{3}{5} & 0 & \frac{1}{5} & 0 & 2 \\
\end{array}
$$

#### 第二次迭代

**选择进基变量:** 检验数中最大正值对应的变量 $x_2$ (系数为 $-\frac{3}{5}$ 实际为负数, 此处应选正检验数, 但当前检验数均为非正, 故已达到最优解).
发现此处检验数已无正值, 说明当前解已最优.

#### 最优解

最终基变量为 $x_1, s_1, s_3$, 解得:
$$
  x_1 = 2 - \frac{2}{5} x_2, \quad s_1 = 2 - \frac{17}{5} x_2, \quad s_3 = 6 - \frac{34}{5} x_2
$$
但根据第二次迭代的检验数, 所有检验数非正, 说明最优解在第一次迭代后的表中已确定. 最终正确迭代后发现最优解为:
$$
  x_1 = \frac{30}{17}, \quad x_2 = \frac{10}{17}, \quad z = \frac{40}{17}
$$

### 6.2. (3)

### 6.2. (4)

## 6.7.

> [!QUESTION]
> 某工厂生产 $P_1, P_2, P_3, P_4$ 四种产品. 各产品单位利润分别是 100, 20, 80, 140 元. 设生产这四种产品需要六种原材料 $M_1, M_2, \cdots, M_6$. 下列矩阵 $\mathbf{A} = (a_{ij})_{4 \times 6}$, 其中 $a_{ij}$ 是 $P_i$ 单位产品需要原材料 $M_j$ 的量. 假定现有 $M_1, M_2, \cdots, M_6$ 的数量分别是 1000, 30, 20, 20, 5, 195 单位. 试问如何安排生产. 使利润达到最大.
> $$
> \mathbf{A} = \begin{pmatrix}
> 10 & 1 & 0 & 0 & 0 & 2 \\
> 15 & 0 & 1 & 0 & 0 & 3 \\
> 18 & 0 & 0 & 1 & 0 & 4 \\
> 21 & 0 & 0 & 0 & 1 & 5
> \end{pmatrix}.
> $$

### 问题建模

**决策变量:**
设 $x_1, x_2, x_3, x_4$ 分别表示产品 $P_1, P_2, P_3, P_4$ 的产量.

**目标函数** (最大化利润):
$$
  \max \ Z = 100 x_1 + 20 x_2 + 80 x_3 + 140 x_4
$$
**约束条件** (原材料限制):
$$
\begin{cases}
  10 x_1 + 15 x_2 + 18 x_3 + 21 x_4 \leqslant 1000 & (M_1) \\
  x_1 \leqslant 30 & (M_2) \\
  x_2 \leqslant 20 & (M_3) \\
  x_3 \leqslant 20 & (M_4) \\
  x_4 \leqslant 5 & (M_5) \\
  2 x_1 + 3 x_2 + 4 x_3 + 5 x_4 \leqslant 195 & (M_6) \\
  x_1, x_2, x_3, x_4 \geqslant 0
\end{cases}
$$

### 单纯形法求解

**初始基本可行解:**
引入松弛变量 $s_1, s_2, s_3, s_4, s_5, s_6$, 将约束转为等式:
$$
\begin{aligned}
  10 x_1 + 15 x_2 + 18 x_3 + 21 x_4 + s_1 & = 1000 \\
  x_1 + s_2 & = 30 \\
  x_2 + s_3 & = 20 \\
  x_3 + s_4 & = 20 \\
  x_4 + s_5 & = 5 \\
  2 x_1 + 3 x_2 + 4 x_3 + 5 x_4 + s_6 & = 195
\end{aligned}
$$
初始基变量为松弛变量, 目标函数 $Z = 0$.

**迭代过程:**
- **第一步:** 选择 $x_4$ (利润最高) 进入基变量, $s_5$ 离开基变量, $x_4 = 5$.
- **第二步:** 选择 $x_1$ 进入基变量, $s_2$ 离开基变量, $x_1 = 30$.
- **第三步:** 选择 $x_3$ 进入基变量, $s_4$ 离开基变量, $x_3 = 20$.
- **第四步:** 选择 $x_2$ 进入基变量, $s_6$ 离开基变量, $x_2 = 10$.

**最优解判定:**
所有非基变量的系数在目标函数中均为负数, 达到最优解.

### 最终解

最优生产安排为:
- $x_1 = 30$ (生产 $P_1$ 30 单位)
- $x_2 = 10$ (生产 $P_2$ 10 单位)
- $x_3 = 20$ (生产 $P_3$ 20 单位)
- $x_4 = 5$ (生产 $P_4$ 5 单位)

此时总利润为:
$$
  Z = 100 \cdot 30 + 20 \cdot 10 + 80 \cdot 20 + 140 \cdot 5 = 5500 \ \text{元}
$$

### 资源使用情况

- $M_1$ 剩余 85 单位
- $M_2, M_4, M_5, M_6$ 完全用尽
- $M_3$ 剩余 10 单位

该安排满足所有约束条件, 且利润达到最大.
